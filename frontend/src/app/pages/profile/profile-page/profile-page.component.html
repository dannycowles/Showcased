@if (profileData) {
  <div class="d-flex flex-column align-items-center mt-5">
    <h3 class="mb-3">{{profileData.username}}</h3>
    <img class="mb-3" id="profile-picture" [ngSrc]="profileData.profilePicture" alt="Profile Picture" width="500" height="500" priority>
    <input class="mb-3" type="file" accept="image/jpeg, image/png" required (change)="onFileSelected($event)">

    <div class="d-flex m-3 gap-5">
      <a class="d-flex flex-column align-items-center text-decoration-none text-dark" href="/profile/followers">
        <h3>{{profileData.numFollowers}}</h3>
        <h4>Followers</h4>
      </a>
      <a class="d-flex flex-column align-items-center text-decoration-none text-dark" href="/profile/following">
        <h3>{{profileData.numFollowing}}</h3>
        <h4>Following</h4>
      </a>
    </div>
    <pre class="fs-3">{{profileData.bio}}</pre>
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#bioModal">Edit Bio</button>
    <button class="btn btn-secondary mt-3 mb-3" data-bs-toggle="modal" data-bs-target="#socialModal">Edit Social Accounts</button>
    @for (social of profileData.socials; track social.socialId) {
      <div>
        {{social.socialName}} - {{social.handle}}
      </div>
    }
  </div>

  <div class="modal fade" id="bioModal" aria-labelledby="bioModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="bioModalLabel">Edit Bio</h1>
          <button class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body mb-3">
          <label for="bioInput" class="form-label">Bio</label>
          <textarea class="form-control" id="bioInput" [maxLength]="bioMaxLength"  [(ngModel)]="newBio"
                    (input)="utilsService.displayCharactersLeft('bioInput', 'bioHelpBlock', bioMaxLength)"></textarea>
          <div id="bioHelpBlock" class="form-text">{{ bioMaxLength - newBio?.length}} characters remaining</div>
          <div class="mt-3 text-success">
            {{ bioMessage }}
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button class="btn btn-primary" (click)="updateBio()">Save Changes</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="socialModal" aria-labelledby="socialModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="socialModalLabel">Edit Social Accounts</h1>
          <button class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          @for (social of profileData.socials; track social.socialId) {
            <div>
              {{social.socialName}} - {{social.handle}}
            </div>
          }
        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <br>
  <br>
  <h3>Watchlist</h3>
  @if (profileData.watchlistTop.length != 0) {
    @for (show of profileData.watchlistTop; track show.showId) {
      <h5>{{show.title}}</h5>

      <!-- Poster images are sized w185, using 2:3 ratio -->
      <a [routerLink]="['/show', show.showId]"><img [ngSrc]="show.posterPath" alt="Show Poster" width="185" height="278" priority></a>
    }
    <br>
    <br>
    <button routerLink="/profile/watchlist">Manage Watchlist</button>
    <br>
    <br>

  } @else {
    <p>Nothing on watchlist yet!</p>
  }

  <h3>Currently Watching</h3>
  @if (profileData.watchingTop.length != 0) {
    @for (show of profileData.watchingTop; track show.showId) {
      <h5>{{show.title}}</h5>

      <!-- Poster images are sized w185, using 2:3 ratio -->
      <a [routerLink]="['/show', show.showId]"><img [ngSrc]="show.posterPath" alt="Show Poster" width="185" height="278" priority></a>
    }
    <br>
    <br>
    <button routerLink="/profile/watching">Manage Currently Watching</button>
    <br>
    <br>
  } @else {
    <p>Not watching anything!</p>
  }

  <h3>Favorite Shows</h3>
  @if (profileData.showRankingTop.length != 0) {
    @for (show of profileData.showRankingTop; track show.showId) {
      <h5>{{show.rankNum}}</h5>
      <h5>{{show.title}}</h5>

      <!-- Poster images are sized w185, using 2:3 ratio -->
      <a [routerLink]="['/show', show.showId]"><img [ngSrc]="show.posterPath" alt="Show Poster" width="185" height="278" priority></a>
    }
    <br>
    <br>
    <button routerLink="/profile/show-ranking">Manage Favorite Shows</button>
    <br>
    <br>
  } @else {
    <p>Nothing ranked yet!</p>
  }

  <h3>Favorite Seasons</h3>
  @if (profileData.seasonRankingTop.length != 0) {
    @for (season of profileData.seasonRankingTop; track season.id) {
      <h5>{{season.rankNum}}</h5>
      <h5>{{season.showTitle}} Season {{season.season}}</h5>

      <!-- Poster images are sized w185, using 2:3 ratio -->
      <a [routerLink]="['/show', season.showId, 'season', season.season]"><img [ngSrc]="season.posterPath" alt="Season Poster" width="185" height="278" priority></a>
    }

    <br>
    <br>
    <button routerLink="/profile/season-ranking">Manage Favorite Seasons</button>
    <br>
    <br>
  } @else {
    <p>Nothing ranked yet!</p>
  }

  <h3>Favorite Episodes</h3>
  @if (profileData.episodeRankingTop.length != 0) {
    @for (episode of profileData.episodeRankingTop; track episode.showId) {
      <h5>{{episode.rankNum}}</h5>
      <h5>Show: {{episode.showTitle}}</h5>
      <h5>Episode: {{episode.episodeTitle}}</h5>
      <h5>S{{episode.season}} E{{episode.episode}}</h5>

      <!-- Episode stills are sized w185, with a 16:9 ratio -->
      <a [routerLink]="['/show', episode.showId, 'season', episode.season, 'episode', episode.episode]"><img [ngSrc]="episode.posterPath" alt="Show Poster" width="185" height="104" priority></a>
    }
    <br>
    <br>
    <button routerLink="/profile/episode-ranking">Manage Favorite Episodes</button>
    <br>
    <br>
  } @else {
    <p>Nothing ranked yet!</p>
  }

  <h3>Favorite Protagonists</h3>
  @if (profileData.protagonistRankingTop.length != 0) {
    @for (character of profileData.protagonistRankingTop; track character.name) {
      <h5>{{character.rankNum}}</h5>
      <h5>{{character.name}} - {{character.show}}</h5>
    }
    <button routerLink="character-ranking/protagonists">Manage Favorite Protagonists</button>
    <br>
    <br>
  } @else {
    <p>Nothing ranked yet!</p>
  }

  <h3>Favorite Deuteragonists</h3>
  @if (profileData.deuteragonistRankingTop.length != 0) {
    @for (character of profileData.deuteragonistRankingTop; track character.name) {
      <h5>{{character.rankNum}}</h5>
      <h5>{{character.name}} - {{character.show}}</h5>
    }
    <button routerLink="character-ranking/deuteragonists">Manage Favorite Deuteragonists</button>
    <br>
    <br>
  } @else {
    <p>Nothing ranked yet!</p>
  }

  <h3>Favorite Antagonists</h3>
  @if (profileData.antagonistRankingTop.length != 0) {
    @for (character of profileData.antagonistRankingTop; track character.name) {
      <h5>{{character.rankNum}}</h5>
      <h5>{{character.name}} - {{character.show}}</h5>
    }
    <button routerLink="character-ranking/antagonists">Manage Favorite Antagonists</button>
    <br>
    <br>
  } @else {
    <p>Nothing ranked yet!</p>
  }

  <h3>Reviews</h3>
  @if (profileData.reviews.length != 0) {
    @for (review of profileData.reviews; track review.id) {
      <h4>Date: {{utilsService.getFormattedDate(review.reviewDate)}}</h4>
      <h4>Relative Time Since Review: {{review.relativeDate}}</h4>
      <h4>Show: {{review.showTitle}}</h4>
      <h4>Rating: {{review.rating}}</h4>
      <h4>Commentary: {{review.commentary}}</h4>
      <h4>Contains Spoilers: {{review.containsSpoilers}}</h4>
      <h4>Likes: {{review.likes}}</h4>
      <br>
    }
  } @else {
    <p>No reviews yet!</p>
  }

}

